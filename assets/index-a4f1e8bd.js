import{z as H,ad as C,d as z,i as r,af as K,a6 as $,al as w,at as M,au as j,ak as E,x as k,s as J,m as D,aX as _,ai as B,a1 as I,aJ as X,aa as Y,ao as O,am as A,a5 as P,n as q,ba as G,V as F,F as Q,a0 as W,av as Z,aM as p,bb as ee,an as ne,ae as re,aO as N,aB as ae}from"./index-e227146f.js";import{L as te}from"./index-75b16952.js";const ie=Symbol(),oe=()=>H(ie,null),[ce,R]=C("tag"),le={size:String,mark:Boolean,show:$,type:w("default"),color:String,plain:Boolean,round:Boolean,textColor:String,closeable:Boolean};var de=z({name:ce,props:le,emits:["close"],setup(e,{slots:n,emit:c}){const l=o=>{o.stopPropagation(),c("close",o)},s=()=>e.plain?{color:e.textColor||e.color,borderColor:e.color}:{color:e.textColor,background:e.color},u=()=>{var o;const{type:y,mark:v,plain:t,round:h,size:f,closeable:x}=e,b={mark:v,plain:t,round:h};f&&(b[f]=f);const i=x&&r(j,{name:"cross",class:[R("close"),M],onClick:l},null);return r("span",{style:s(),class:R([b,y])},[(o=n.default)==null?void 0:o.call(n),i])};return()=>r(K,{name:e.closeable?"van-fade":void 0},{default:()=>[e.show?u():null]})}});const se=E(de),[ue,T]=C("image"),fe={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:P,height:P,radius:P,lazyLoad:Boolean,iconSize:P,showError:$,errorIcon:w("photo-fail"),iconPrefix:String,showLoading:$,loadingIcon:w("photo"),crossorigin:String,referrerpolicy:String};var ge=z({name:ue,props:fe,emits:["load","error"],setup(e,{emit:n,slots:c}){const l=k(!1),s=k(!0),u=k(),{$Lazyload:o}=J().proxy,y=D(()=>{const a={width:_(e.width),height:_(e.height)};return B(e.radius)&&(a.overflow="hidden",a.borderRadius=_(e.radius)),a});I(()=>e.src,()=>{l.value=!1,s.value=!0});const v=a=>{s.value&&(s.value=!1,n("load",a))},t=()=>{const a=new Event("load");Object.defineProperty(a,"target",{value:u.value,enumerable:!0}),v(a)},h=a=>{l.value=!0,s.value=!1,n("error",a)},f=(a,m,S)=>S?S():r(j,{name:a,size:e.iconSize,class:m,classPrefix:e.iconPrefix},null),x=()=>{if(s.value&&e.showLoading)return r("div",{class:T("loading")},[f(e.loadingIcon,T("loading-icon"),c.loading)]);if(l.value&&e.showError)return r("div",{class:T("error")},[f(e.errorIcon,T("error-icon"),c.error)])},b=()=>{if(l.value||!e.src)return;const a={alt:e.alt,class:T("img"),style:{objectFit:e.fit,objectPosition:e.position},crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy};return e.lazyLoad?q(r("img",F({ref:u},a),null),[[G("lazy"),e.src]]):r("img",F({ref:u,src:e.src,onLoad:v,onError:h},a),null)},i=({el:a})=>{const m=()=>{a===u.value&&s.value&&t()};u.value?m():A(m)},g=({el:a})=>{a===u.value&&!l.value&&h()};return o&&X&&(o.$on("loaded",i),o.$on("error",g),Y(()=>{o.$off("loaded",i),o.$off("error",g)})),O(()=>{A(()=>{var a;(a=u.value)!=null&&a.complete&&!e.lazyLoad&&t()})}),()=>{var a;return r("div",{class:T({round:e.round,block:e.block}),style:y.value},[b(),x(),(a=c.default)==null?void 0:a.call(c)])}}});const me=E(ge),[ve,d]=C("card"),he={tag:String,num:P,desc:String,thumb:String,title:String,price:P,centered:Boolean,lazyLoad:Boolean,currency:w("Â¥"),thumbLink:String,originPrice:P};var be=z({name:ve,props:he,emits:["clickThumb"],setup(e,{slots:n,emit:c}){const l=()=>{if(n.title)return n.title();if(e.title)return r("div",{class:[d("title"),"van-multi-ellipsis--l2"]},[e.title])},s=()=>{if(n.tag||e.tag)return r("div",{class:d("tag")},[n.tag?n.tag():r(se,{mark:!0,type:"primary"},{default:()=>[e.tag]})])},u=()=>n.thumb?n.thumb():r(me,{src:e.thumb,fit:"cover",width:"100%",height:"100%",lazyLoad:e.lazyLoad},null),o=()=>{if(n.thumb||e.thumb)return r("a",{href:e.thumbLink,class:d("thumb"),onClick:t=>c("clickThumb",t)},[u(),s()])},y=()=>{if(n.desc)return n.desc();if(e.desc)return r("div",{class:[d("desc"),"van-ellipsis"]},[e.desc])},v=()=>{const t=e.price.toString().split(".");return r("div",null,[r("span",{class:d("price-currency")},[e.currency]),r("span",{class:d("price-integer")},[t[0]]),t.length>1&&r(Q,null,[W("."),r("span",{class:d("price-decimal")},[t[1]])])])};return()=>{var t,h,f;const x=n.num||B(e.num),b=n.price||B(e.price),i=n["origin-price"]||B(e.originPrice),g=x||b||i||n.bottom,a=b&&r("div",{class:d("price")},[n.price?n.price():v()]),m=i&&r("div",{class:d("origin-price")},[n["origin-price"]?n["origin-price"]():`${e.currency} ${e.originPrice}`]),S=x&&r("div",{class:d("num")},[n.num?n.num():`x${e.num}`]),U=n.footer&&r("div",{class:d("footer")},[n.footer()]),V=g&&r("div",{class:d("bottom")},[(t=n["price-top"])==null?void 0:t.call(n),a,m,S,(h=n.bottom)==null?void 0:h.call(n)]);return r("div",{class:d()},[r("div",{class:d("header")},[o(),r("div",{class:d("content",{centered:e.centered})},[r("div",null,[l(),y(),(f=n.tags)==null?void 0:f.call(n)]),V])]),U])}}});const ke=E(be),[xe,L,ye]=C("list"),Se={error:Boolean,offset:Z(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:w("down"),loadingText:String,finishedText:String,immediateCheck:$};var Pe=z({name:xe,props:Se,emits:["load","update:error","update:loading"],setup(e,{emit:n,slots:c}){const l=k(e.loading),s=k(),u=k(),o=oe(),y=p(s),v=D(()=>e.scroller||y.value),t=()=>{A(()=>{if(l.value||e.finished||e.disabled||e.error||(o==null?void 0:o.value)===!1)return;const{direction:i}=e,g=+e.offset,a=N(v);if(!a.height||ae(s))return;let m=!1;const S=N(u);i==="up"?m=a.top-S.top<=g:m=S.bottom-a.bottom<=g,m&&(l.value=!0,n("update:loading",!0),n("load"))})},h=()=>{if(e.finished){const i=c.finished?c.finished():e.finishedText;if(i)return r("div",{class:L("finished-text")},[i])}},f=()=>{n("update:error",!1),t()},x=()=>{if(e.error){const i=c.error?c.error():e.errorText;if(i)return r("div",{role:"button",class:L("error-text"),tabindex:0,onClick:f},[i])}},b=()=>{if(l.value&&!e.finished&&!e.disabled)return r("div",{class:L("loading")},[c.loading?c.loading():r(te,{class:L("loading-icon")},{default:()=>[e.loadingText||ye("loading")]})])};return I(()=>[e.loading,e.finished,e.error],t),o&&I(o,i=>{i&&t()}),ee(()=>{l.value=e.loading}),O(()=>{e.immediateCheck&&t()}),ne({check:t}),re("scroll",t,{target:v,passive:!0}),()=>{var i;const g=(i=c.default)==null?void 0:i.call(c),a=r("div",{ref:u,class:L("placeholder")},null);return r("div",{ref:s,role:"feed",class:L(),"aria-busy":l.value},[e.direction==="down"?g:a,b(),h(),x(),e.direction==="up"?g:a])}}});const we=E(Pe);export{ke as C,we as L,se as T};
